if(!Mediasite)var Mediasite={};Mediasite.Player=Mediasite.Player||{},Mediasite.Player.ImageSizeProvider=function(){function runSizer(n,t,i,r){n(t,function(n){n?i(n):r()})}function parseHeaderToSize(n){var t,r,i;return typeof n!="string"?null:(t=n.split("x"),t.length!==2)?null:(r=parseInt(t[0]),i=parseInt(t[1]),isNaN(r)||isNaN(i))?null:new Mediasite.Geometry.Size(r,i)}function debug(){}function fetchKnownSize(n,i){debug("fetchKnownSize"),i(t[n])}function makeHeadRequestForSize(n,t){if(debug("makeHeadRequestForSize"),!Mediasite.Player.ImageSizeProvider.useXHR){t(null);return}var i=$.ajax(n,{type:"HEAD",global:!1}).done(function(){var r=i.getResponseHeader("x-native-dimensions"),n=parseHeaderToSize(r);t(n)}).fail(function(){debug("ajax fail"),t(null)})}function measureImageForSize(n,t){debug("measureImageForSize"),r.measure(n,function(n){n&&!Mediasite.Geometry.Size.Zero().equals(n)?t(n):t(null)})}function guessSize(t,r){debug("guessSize"),r(n||i)}var u=this,t={},i=new Mediasite.Geometry.Size(800,600),n=i,r=new Mediasite.Player.ImageRuler;this.getSize=function(t,i){function foundSize(r){debug("foundSize "+r.toString()),u.rememberSize(t,r),n=r,i(r)}if(!t){i(Mediasite.Geometry.Size.Zero());return}runSizer(fetchKnownSize,t,foundSize,function(){runSizer(makeHeadRequestForSize,t,foundSize,function(){runSizer(measureImageForSize,t,foundSize,function(){runSizer(guessSize,t,foundSize,function(){throw"Failed to determine slide dimensions.";})})})})},this.rememberSize=function(n,i){return n&&(t[n]=i),i}},Mediasite.Player.ImageSizeProvider.useXHR=window.location.href.indexOf("file:")!=0,Mediasite.Player.ImageRuler=function(){function clearImg(){n.unbind(),n.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}var n=$("<img />");this.measure=function(t,i){n.bind({load:function(){clearImg(),i(new Mediasite.Geometry.Size(this.width,this.height))},error:function(){clearImg(),i(Mediasite.Geometry.Size.Zero())}}),typeof t=="string"&&t.length>0?n.attr("src",t):n.trigger("error")}}
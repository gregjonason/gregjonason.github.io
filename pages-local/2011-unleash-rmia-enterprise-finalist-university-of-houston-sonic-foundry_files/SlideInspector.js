if(!Mediasite)var Mediasite={};Mediasite.Player=Mediasite.Player||{},Mediasite.Player.ZoomHud=function(n){function init(){i=$("<div />").appendTo(t).addClass("zoomhud-expanded"),l=$("<div />").appendTo(i).addClass("zoomhud-percentage"),u=$('<div tabindex="0" />').appendTo(i).addClass("zoomhud-zoomInButton").imageButton(),f=$('<div tabindex="0" />').appendTo(i).addClass("zoomhud-zoomOutButton").imageButton(),r=$("<div />").appendTo(t).addClass("zoomhud-collapsed"),e=$('<div tabindex="0" />').appendTo(r).addClass("zoomhud-zoomInButton").imageButton(),u.click(zoomInButton_click),e.click(zoomInButton_click),f.click(zoomOutButton_click),u.bind("keypress",function(n){n.keyCode==13&&u.trigger("click")}),e.bind("keypress",function(n){n.keyCode==13&&e.trigger("click")}),f.bind("keypress",function(n){n.keyCode==13&&f.trigger("click")}),this.collapse(0)}function zoomInButton_click(){o=!0,t.trigger("zoominclicked")}function zoomOutButton_click(){h=!0,t.trigger("zoomoutclicked")}function toPercentageText(n){if(typeof n!="number")return"";var t=Math.max(Math.round(n*100),0);return a.replace(/NUMBER/,t)}var t=$(n),c=0,s=!1,a="NUMBER%",v=this,o=!1,h=!1,i,l,u,f,r,e;this.getElement=function(){return t},this.getZoomFactor=function(){return c},this.setZoomFactor=function(n){c=n,l.text(toPercentageText(n))},this.getZoomInEnabled=function(){return!u.imageButton("getIsDisabled")},this.setZoomInEnabled=function(n){u.imageButton(n?"enable":"disable"),e.imageButton(n?"enable":"disable")},this.getZoomOutEnabled=function(){return!f.imageButton("getIsDisabled")},this.setZoomOutEnabled=function(n){f.imageButton(n?"enable":"disable")},this.getIsExpanded=function(){return s},this.expand=function(n){function refocusZoomInButton(){o&&(o=!1,$(".zoomhud-expanded .zoomhud-zoomInButton").focus())}s=!0,i.stop(!0,!0),r.stop(!0,!0),i.fadeIn(n),r.fadeOut(n,refocusZoomInButton)},this.collapse=function(n){function refocusZoomInButton(){h&&(h=!1,$(".zoomhud-collapsed .zoomhud-zoomInButton").focus())}s=!1,i.stop(!0,!0),r.stop(!0,!0),i.fadeOut(n),r.fadeIn(n,refocusZoomInButton)},this.bind=function(){t.bind.apply(t,arguments)},this.unbind=function(){t.unbind.apply(t,arguments)},init.call(this)},Mediasite.Player.SlideInspector=function(n){function init(){u=$(n).css(getSelectFocusDragCss()).css("overflow","hidden"),u.css("position")=="static"&&u.css("position","relative"),h=$("<div />").appendTo(u).addClass("inspector-zoomable-slide"),_hudElement=$("<div />").appendTo(u).addClass("zoomhud"),i=new Mediasite.Player.ZoomableSlide(h),e=new Mediasite.Player.ZoomViewport(u),t=new Mediasite.Player.ZoomEngine(i.getNativeSize(),e.getSize()),r=new Mediasite.Player.ZoomHud(_hudElement),e.bind({mousedragged:viewport_mousedragged,mousewheelup:viewport_mousewheelup,mousewheeldown:viewport_mousewheeldown,sizechanged:viewport_sizechanged,pinched:viewport_pinched}),i.bind("nativesizechanged",slide_nativesizechanged),t.bind({contentrectchanged:zoomEngine_contentrectchanged,capabilitieschanged:zoomEngine_capabilitieschanged,zoomfactorchanged:zoomEngine_zoomfactorchanged}),r.bind({zoominclicked:hud_zoominclicked,zoomoutclicked:hud_zoomoutclicked}),u.bind({mouseenter:element_mouseenter,mousemove:element_mousemove,mouseleave:element_mouseleave,touchstart:element_touchstart}),checkZoomedAllOut(),hideHud(!0)}function viewport_mousedragged(n,i){t.pan(i.delta.x,i.delta.y)}function viewport_mousewheelup(n,i){t.zoomIn(i.position)}function viewport_mousewheeldown(n,i){t.zoomOut(i.position)}function viewport_sizechanged(){t.setViewportSize(e.getSize())}function viewport_pinched(n,i){t.zoom(i.position,i.scaleFactor)}function slide_nativesizechanged(){t.setNativeSize(i.getNativeSize())}function zoomEngine_contentrectchanged(n,t){i.applyRect(t.rect,t.mayAnimate)}function zoomEngine_capabilitieschanged(){r.setZoomInEnabled(t.getCanZoomIn()),r.setZoomOutEnabled(t.getCanZoomOut()),checkZoomedAllOut(),u.css("cursor",t.getCanZoomOut()?"pointer":"default")}function zoomEngine_zoomfactorchanged(){r.setZoomFactor(t.getZoomFactor())}function element_mouseenter(){showHud()}function element_mousemove(){showHud()}function element_mouseleave(){hideHud()}function element_touchstart(){o&&clearTimeout(o),o=setTimeout(function(){hideHud()},5e3),showHud()}function hud_zoominclicked(){t.zoomIn(),_zoominclicked=!1}function hud_zoomoutclicked(){t.zoomOut(),_zoomoutclicked=!1}function checkZoomedAllOut(){t.getCanZoomOut()?handleNotZoomedAllOut():handleZoomedAllOut()}function handleZoomedAllOut(){s,r.collapse(200)}function handleNotZoomedAllOut(){r.expand(200)}function getSelectFocusDragCss(){for(var r=["-webkit-","-khtml-","-moz-","-o-",""],i={},t,n=0;n<r.length;n++)t=r[n],i[t+"user-select"]="none",i[t+"user-focus"]="ignore",i[t+"user-drag"]="none";return i}function showHud(){f&&r.getElement().stop(!0,!0).fadeIn()}function hideHud(n){n?r.getElement().hide():t.getCanZoomOut()||r.getElement().stop(!0,!0).fadeOut()}var u,h,i,e,t,r,s=!1,f=!0,o;this.getSlideImage=function(){return i.getSlideImage()},this.setSlideImage=function(n){i.setSlideImage(n)},this.getSlideToolTip=function(){return i.getToolTip()},this.setSlideToolTip=function(n){i.setToolTip(n)},this.getSlideAspectRatio=function(){return i.getAspectRatio()},this.setSlideAspectRatio=function(n){i.setAspectRatio(n)},this.getIsTransparentWhenZoomedOut=function(){return s},this.setIsTransparentWhenZoomedOut=function(n){s=n,checkZoomedAllOut()},this.getCanZoom=function(){return f},this.setCanZoom=function(n){f=n,t.setCanZoom(f),f||hideHud(!0)},init()},Mediasite.Player.ZoomEngine=function(n,t){function onContentRectChanged(n){s.trigger("contentrectchanged",{rect:r,mayAnimate:n})}function onCapabilitiesChanged(){s.trigger("capabilitieschanged")}function onZoomFactorChanged(){s.trigger("zoomfactorchanged")}function onOverPan(n,t){s.trigger("overpan",{x:n,y:t})}function getZoomJumpFactors(n){for(var t={up:l,down:f},r=0;r<c.length;r++){var i=c[r],e=i==1,u=i>f*a;if(u||e)if(i<n)t.down=i;else if(i>n){t.up=i;break}}return t.down=Math.max(t.down,f),t.up=Math.max(t.up,n),t}function areSizesValid(){return o.width()>0&&o.height()>0&&u.width()>0&&o.height()>0}function setContentRect(n,t){var i=enforceContainment(n),f,u;i.equals(n)||(f=n.left()-i.left(),u=n.top()-i.top(),onOverPan(f,u)),r.equals(i)||(r=i,onContentRectChanged(t))}function enforceContainment(n){var i=fixOffset(n.left(),n.width(),u.width()),t=fixOffset(n.top(),n.height(),u.height());return new Mediasite.Geometry.Rect(i,t,n.width(),n.height())}function fixOffset(n,t,i){if(t<i)return Math.round((i-t)/2);var r=i-t;return Math.ceil(Math.max(Math.min(n,0),r))}function respondToZoom(n){var t=calculateRect(n);setContentRect(t,!0),onZoomFactorChanged(),onCapabilitiesChanged()}function calculateRect(n){if(!areSizesValid())return v;var t=calculateAdjustedSize(),f=calculateZoomedOffset(r.left(),n.x(),r.width(),t.width()),u=calculateZoomedOffset(r.top(),n.y(),r.height(),t.height());return new Mediasite.Geometry.Rect(f,u,t.width(),t.height())}function calculateZoomedOffset(n,t,i,r){if(i==0)return 0;var e=r/i,f=t-n,u=f*e;return-(u-t)}function calculateAdjustedSize(){return new Mediasite.Geometry.Size(Math.round(o.width()*i),Math.round(o.height()*i))}function updateMinLevel(){var n=i==f;f=calculateJustFitsFactor(o,u),(n||i<f)&&(i=f)}function getViewportCenter(){return new Mediasite.Geometry.Point(u.width()/2,u.height()/2)}function calculateJustFitsFactor(n,t){if(!areSizesValid())return 0;var r=t.width()/n.width(),i=t.height()/n.height();return Math.min(r,i)}var h=new Mediasite.Geometry.Size(0,0),v=new Mediasite.Geometry.Rect(0,0,0,0),y=new Mediasite.Geometry.Point(0,0),o=n||h,u=t||h,c=[.05,.1,.15,.25,.5,.75,1,1.5,2],l=c[c.length-1],f=calculateJustFitsFactor(o,u),a=1.2,i=f,r=new Mediasite.Geometry.Rect(0,0,u.width(),u.height()),s=$("<div />"),e=!0;this.getZoomFactor=function(){return i},this.getCanZoomIn=function(){return e&&i<l},this.getCanZoomOut=function(){return e&&i>f},this.getCanZoom=function(){return e},this.setCanZoom=function(n){n||this.zoomAllOut(),e=n},this.getNativeSize=function(){return o},this.setNativeSize=function(n){o=n||h,updateMinLevel(),respondToZoom(getViewportCenter())},this.getViewportSize=function(){return u},this.setViewportSize=function(n){u=n||h,updateMinLevel(),respondToZoom(getViewportCenter())},this.getContentRect=function(){return r},this.zoomOut=function(n){if(e){var t=n||getViewportCenter();i=getZoomJumpFactors(i).down,respondToZoom(t)}},this.zoomIn=function(n){if(e){var t=n||getViewportCenter();i=getZoomJumpFactors(i).up,respondToZoom(t)}},this.zoom=function(n,t){e&&(i=Math.min(l,Math.max(f,t*i)),respondToZoom(n))},this.zoomAllOut=function(){e&&this.zoom(y,0)},this.pan=function(n,t){if(e){var i=new Mediasite.Geometry.Rect(r.left()+n,r.top()+t,r.width(),r.height());setContentRect(i,!1)}},this.bind=function(){s.bind.apply(s,arguments)},this.unbind=function(){s.unbind.apply(s,arguments)}},Mediasite.Player.ZoomableSlide=function(n){function setNativeSize(n){r.equals(n)||(r=n,onNativeSizeChanged())}function onNativeSizeChanged(){i.trigger("nativesizechanged")}function areTransformsAvailable(){return Mediasite.Player.Support.csstransforms3d}function applyRectBasic(n){i.css({left:n.left(),top:n.top()}),t.css({left:0,top:0,width:n.width(),height:n.height()})}function applyRectFancy(n){var f=n.width()/r.width();(t.height()!=r.height()||t.width()!=r.width())&&t.css({width:r.width(),height:r.height()}),i.css(makeTransformCssMap(n.left(),n.top(),1)),t.css(makeTransformCssMap(0,0,f))}function makeTransformCssMap(n,t,i){for(var f={},u,r=0;r<s.length;r++)u=s[r],f[u+"transform-origin"]="top left",f[u+"transform"]="scale3d("+i+","+i+",1.0) "+makeTranslateValue(n,t);return f}function makeTranslateValue(n,t){return"translate3d("+n+"px, "+t+"px, 0px)"}function loadSlide(){if(!hasSlide()){showImage(""),setNativeSize(a);return}var n=u.getFullUrl();n&&n.resolve||(n=$.Deferred().resolve(n)),n.done(function(n){h.getSize(n,function(n){setNativeSize(n),loadRightSizedImage()})})}function loadRightSizedImage(n){var o=n||f,t,i,r;hasSlide()&&(i=e.getNativeSize().width()/e.getNativeSize().height(),r=Mediasite.Slide.getCacheFriendlyImageSize(o,i),t=r.height()<e.getNativeSize().height()?u.getCacheFriendlyUrl(o,i):u.getFullUrl(),t&&t.resolve||(t=$.Deferred().resolve(t)),t.done(function(n){showImage(n)}))}function hasSlide(){return u&&typeof u.getSlideNumber()=="number"}function showImage(n){n!==o&&(typeof n=="string"&&n.length>0?(t.attr("src",n),setImgOpacity(1)):(t.removeAttr("src"),setImgOpacity(0)),o=n)}function setImgOpacity(n){var i=Number(t.css("opacity"));n!==i&&t.css("opacity",n)}var f=0,e=this,i=n,t,o;i.css("position","absolute"),t=$("<img />").appendTo(i).width("100%").height("100%"),t.bind("dragstart",function(n){n.preventDefault()});var h=new Mediasite.Player.ImageSizeProvider,u,a=new Mediasite.Geometry.Size(0,0),r=new Mediasite.Geometry.Size(800,600),l=4/3,c=l,v="",s=["-webkit-","-moz-","-o-","-ms-"];this.getElement=function(){return i},this.setImageSizeProvider=function(n){h=n},this.getSlideImage=function(){return u},this.setSlideImage=function(n){u=n,loadSlide()},this.getNativeSize=function(){return r},this.getAspectRatio=function(){return c},this.setAspectRatio=function(n){c=n>0?n:l,loadSlide()},this.getToolTip=function(){return t.attr("title")},this.setToolTip=function(n){t.attr("alt",n).attr("title",n)},this.applyRect=function(n,t){f!=n.height()&&(loadRightSizedImage(n.height()),f=n.height()),areTransformsAvailable()?applyRectFancy(n,t):applyRectBasic(n,t)},this.bind=function(){i.bind.apply(i,arguments)},this.unbind=function(){i.unbind.apply(i,arguments)},o=null},Mediasite.Player.ZoomViewport=function(n){function element_resize(n){n.stopPropagation(),onSizeChanged()}function element_mousewheel(n,t){t>0?onMouseWheelUp():t<0&&onMouseWheelDown()}function element_mousedown(n){f=!0,u=pos(n.pageX,n.pageY)}function element_mouseup(){f=!1}function element_mousemove(n){var t=pos(n.pageX,n.pageY);handleMouseMove(t)}function element_touchstart(n){var t=n.originalEvent;t&&t.targetTouches&&(t.targetTouches.length==1?e=getFirstTouchPosition(t.targetTouches[0]):t.targetTouches.length==2&&(s=1,i=getCenter(t.targetTouches[0],t.targetTouches[1])))}function element_MSPointerDown(n){isTouchPointerEvent(n)?(i=null,o.addPointer(n.pointerId)):f=!0}function element_touchmove(n){var t,i;(n.preventDefault(),t=n.originalEvent,t&&t.targetTouches)&&(t.targetTouches.length==1?handleSingleTouchMove(getFirstTouchPosition(t.targetTouches[0])):t.targetTouches.length==2&&(i=getCenter(t.targetTouches[0],t.targetTouches[1]),handleDoubleTouchMove(i,t.scale)))}function element_MSPointerMove(n){n.preventDefault();var t=getMSPointerPosition(n);!isTouchPointerEvent(n)&&n.isPrimary&&handleMouseMove(t)}function element_touchend(n){var t=n.originalEvent;t.targetTouches.length==1&&(e=getFirstTouchPosition(t.targetTouches[0]))}function element_MSPointerUp(){i=null,f=!1}function element_MSGestureStart(){i=null}function element_MSGestureChange(n){var t=getMSGestureCenter(n),r;i&&(r=calculateDelta(i,t),onMouseDragged(r)),i=t,onPinched(t,n.scale)}function element_MSGestureEnd(){i=null}function getMSGestureCenter(n){var t=document.documentElement;return pos(n.clientX+t.scrollLeft,n.clientY+t.scrollTop)}function onMouseDragged(n){t.trigger("mousedragged",{delta:n})}function onMouseWheelDown(){t.trigger("mousewheeldown",{position:makePositionRelativeToElement(u)})}function onMouseWheelUp(){t.trigger("mousewheelup",{position:makePositionRelativeToElement(u)})}function onSizeChanged(){t.trigger("sizechanged")}function onPinched(n,i){t.trigger("pinched",{position:makePositionRelativeToElement(n),scaleFactor:i})}function isTouchPointerEvent(n){return n.pointerType===n.MSPOINTER_TYPE_TOUCH||n.pointerType==="touch"}function handleMouseMove(n){if(f){var t={x:n.x()-u.x(),y:n.y()-u.y()};onMouseDragged(t)}u=n}function handleSingleTouchMove(n){var t=calculateDelta(e,n);e=n,onMouseDragged(t)}function handleDoubleTouchMove(n,t){var u=calculateDelta(i,n),r;i=n,r=t/s,s=t,onMouseDragged(u),onPinched(n,r)}function calculateDelta(n,t){return{x:t.x()-n.x(),y:t.y()-n.y()}}function getFirstTouchPosition(n){return pos(n.pageX,n.pageY)}function getMSPointerPosition(n){return pos(n.pageX,n.pageY)}function getCenter(n,t){var r=Math.round(n.pageX+(t.pageX-n.pageX)/2),i=Math.round(n.pageY+(t.pageY-n.pageY)/2);return pos(r,i)}function makePositionRelativeToElement(n){var i=t.offset();return new Mediasite.Geometry.Point(n.x()-i.left,n.y()-i.top)}function pos(n,t){return new Mediasite.Geometry.Point(n,t)}var t=$(n),h=!1,f=!1,u=null,e=null,i=null,s=null,o=null,r;t.bind({containerresize:element_resize,mousewheel:element_mousewheel}),window.navigator&&window.navigator.msPointerEnabled&&typeof MSGesture!="undefined"?(r=t.get(0),r.addEventListener("MSPointerDown",element_MSPointerDown),r.addEventListener("MSPointerMove",element_MSPointerMove),r.addEventListener("MSPointerUp",element_MSPointerUp),r.addEventListener("MSGestureStart",element_MSGestureStart),r.addEventListener("MSGestureChange",element_MSGestureChange),r.addEventListener("MSGestureEnd",element_MSGestureEnd),o=new MSGesture,o.target=r):t.bind({mousedown:element_mousedown,mouseup:element_mouseup,mousemove:element_mousemove,touchstart:element_touchstart,touchmove:element_touchmove,touchend:element_touchend}),this.getElement=function(){return t},this.getSize=function(){return new Mediasite.Geometry.Size(t.width(),t.height())},this.bind=function(){t.bind.apply(t,arguments)},this.unbind=function(){t.unbind.apply(t,arguments)}}
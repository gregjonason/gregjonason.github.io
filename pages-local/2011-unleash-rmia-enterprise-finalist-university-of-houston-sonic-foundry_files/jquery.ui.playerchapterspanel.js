(function(n){n.widget("ui.playerchapterspanel",{options:{chapters:null,onChapterChanged:null,ids:{header:"ui-playerchapterspanel-header",scroll:"ui-playerchapterspanel-scroll",scrollWrapper:"ui-playerchapterspanel-scroll-wrapper"},classes:{panel:"ui-playerchapterspanel",header:"panel-header",chapterList:"ui-playerchapterspanel-list",chapterItem:"ui-playerchapterspanel-chapteritem",chapterText:"ui-playerchapterspanel-chaptertext",chapterTime:"ui-playerchapterspanel-chaptertime"},scrollbarColor:"rgba(255,255,255,0.5)"},_setOption:function(n,t){this.options[n]=t,this._bindChapters(),this._super("_setOption",n,t)},_create:function(){var i=this,t=i.options,r;i.element.addClass(t.classes.panel),r='<p id="'+t.ids.header+'" class="'+t.classes.header+'">'+Mediasite.Player.Localization.Buttons.Chapters+'</p><div id="'+t.ids.scrollWrapper+'"><div id="'+t.ids.scroll+'"><div class="'+t.classes.chapterList+'" /></div></div>',i.divMarkup=n(r).appendTo(i.element),n(window).resize(function(){i.updateLayout()})},updateLayout:function(){var u=this,r=u.options,i=n("#"+r.ids.scrollWrapper),t=u.element.height();t-=n("#"+r.ids.header).outerHeight(!0),t-=parseInt(i.css("margin-top"),10)||0,t-=parseInt(i.css("margin-bottom"),10)||0,t-=parseInt(i.css("padding-top"),10)||0,t-=parseInt(i.css("padding-bottom"),10)||0,t=t>0?t:20,i.height(t),n("#"+r.ids.scroll).iscroll({scrollbarColor:r.scrollbarColor})},destroy:function(){var n=this.options;this.element.removeClass(n.classes.panel),this.divMarkup.remove()},_init:function(){this._bindChapters(),this.updateLayout()},_bindChapters:function(){var r=this,t=r.options,i=t.chapters;i&&i.length>0&&n.each(i,function(i,u){var f=Mediasite.Player.TimeHelper.Duration(u.Time),s=Mediasite.Player.Localization.Common.TimeAriaLabel.replaceholders(f.hours,f.minutes,f.seconds),o=Mediasite.Player.Localization.Common.ChapterAriaLabel.replaceholders(i+1,s,u.Text),e=n('<div class="'+t.classes.chapterItem+'" tabindex="0" role="button" aria-label="'+o+'"><div class="'+t.classes.chapterTime+'">'+Mediasite.Player.TimeHelper.getDisplayFromDuration(u.Time,!0)+'</div><div class="'+t.classes.chapterText+'">'+u.Text+"</div></div>").click(function(){if(t.onChapterChanged)t.onChapterChanged(u.Time)}).on("keyup",function(n){if((n.keyCode==32||n.keyCode==13)&&t.onChapterChanged)t.onChapterChanged(u.Time)});n("."+t.classes.chapterList,r.element).append(e)})}})})(jQuery)
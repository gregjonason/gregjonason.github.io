(function(n){n.widget("ui.playerinfopanel",{options:{presentaton:null,onChapterChanged:null,ids:{scroll:"ui-playerinfopanel-scroll",scrollWrapper:"ui-playerinfopanel-scroll-wrapper",header:"ui-playerinfopanel-header",presenters:"ui-playerinfopanel-presenters",description:"ui-playerinfopanel-description",date:"ui-playerinfopanel-date",time:"ui-playerinfopanel-time",duration:"ui-playerinfopanel-duration",dateInfoSection:"ui-playerinfopanel-dateinfo",presenterImage:"ui-playerinfopanel-presenterimage"},classes:{panel:"ui-playerinfopanel",header:"panel-header"},scrollbarColor:"rgba(255,255,255,0.5)",defaultPresenterImageSrc:null,hideDateTime:!1},_setOption:function(n,t){this.options[n]=t,this._bindPresentation(),this._super("_setOption",n,t)},_create:function(){var r=this,t=r.options,i;this.element.addClass(t.classes.panel),i='<div id="'+t.ids.header+'" class="'+t.classes.header+'">Presentation Info</div><div id="'+t.ids.scrollWrapper+'"><div id="'+t.ids.scroll+'"><div id="'+t.ids.presenters+'"><ul /></div><p id="'+t.ids.description+'" /></div></div><div id="'+t.ids.dateInfoSection+'"><span id="'+t.ids.date+'"></span><span id="'+t.ids.time+'"></span>'+Mediasite.Player.Localization.PresentationCard.Duration+'&nbsp;<span id="'+t.ids.duration+'"></span></div>',this.divMarkup=n(i).appendTo(this.element),n(window).resize(function(){r.updateLayout()})},destroy:function(){var n=this.options;this.element.removeClass(n.classes.panel),this.divMarkup.remove()},updateLayout:function(){var u=this,r=u.options,i=n("#"+r.ids.scrollWrapper),t=u.element.height();t-=n("#"+r.ids.header).outerHeight(!0),t-=n("#"+r.ids.dateInfoSection).outerHeight(!0),t-=parseInt(i.css("margin-top"),10)||0,t-=parseInt(i.css("margin-bottom"),10)||0,t-=parseInt(i.css("padding-top"),10)||0,t-=parseInt(i.css("padding-bottom"),10)||0,t=t>0?t:20,i.height(t),n("#"+r.ids.scroll).iscroll({scrollbarColor:r.scrollbarColor})},updateDuration:function(t){var r=this,i=r.options;n("#"+i.ids.duration,this.divMarkup).text(Mediasite.Player.TimeHelper.getDisplayFromDuration(t,!0))},_init:function(){this._bindPresentation(),this.options.hideDateTime&&n("#"+this.options.ids.date,this.divMarkup).add("#"+this.options.ids.time,this.divMarkup).hide(),this.updateLayout()},_bindPresentation:function(){var e=this,i=e.options,t=i.presentation,f,r,u;t&&(t.Title&&n("#"+i.ids.header).text(t.Title),t.Description&&(f=t.Description.formatAsHtml(),n("#"+i.ids.description,this.divMarkup).html(f)),t.Date&&n("#"+i.ids.date,this.divMarkup).text(t.Date),t.Time&&n("#"+i.ids.time,this.divMarkup).text(t.Time),this.updateDuration(t.Duration||0),t.Presenters&&t.Presenters.length>0&&(r=t.Presenters[0],r.ImageUrl?n('<img id="'+i.ids.presenterImage+'" src="'+r.ImageUrl+'" alt="'+r.Name+'" title="'+r.Name+'" class="ui-corner-all" />').prependTo(n("#"+i.ids.presenters)):i.defaultPresenterImageSrc&&n('<img id="'+i.ids.presenterImage+'" src="'+i.defaultPresenterImageSrc+'" alt="'+r.Name+'" title="'+r.Name+'" class="ui-corner-all" />').prependTo(n("#"+i.ids.presenters)),n.each(t.Presenters,function(r){u=t.Presenters[r].BioUrl&&t.Presenters[r].BioUrl.length>0?n('<li><div class="bullet"></div><a href="'+t.Presenters[r].BioUrl+'" target="_blank">'+t.Presenters[r].Name+"</a></li>"):n('<li><div class="bullet"></div>'+t.Presenters[r].Name+"</li>"),u.mouseover(function(){var u=t.Presenters[r];u.ImageUrl?n("#"+i.ids.presenterImage).attr({src:u.ImageUrl,title:u.Name,alt:u.Name}):i.defaultPresenterImageSrc&&n("#"+i.ids.presenterImage).attr({src:i.defaultPresenterImageSrc,title:u.Name,alt:u.Name})}),n("#"+i.ids.presenters+" ul").append(u)})))}})})(jQuery)
(function(n){n.widget("ui.playervolume",{options:{onVolumeChanged:null,onMuteClicked:null,popupSpeed:300,slider:!0,ids:{muteButton:"ui-playervolume-mute",unmuteButton:"ui-playervolume-unmute",muteButtonWrapper:"ui-playervolume-mute-wrapper",unmuteButtonWrapper:"ui-playervolume-unmute-wrapper",volumeDiv:"ui-playervolume-volume",volumeSlider:"ui-playervolume-slider"},muted:!1,previousVolume:50},_setOption:function(n,t){this.options[n]=t,this._super("_setOption",n,t)},_create:function(){function showVolume(){n("#"+t.ids.volumeDiv).stop(!0,!0).animate({height:"show",opacity:"show"},t.popupSpeed)}function hideVolume(){n("#"+t.ids.volumeDiv).stop(!0,!0).animate({height:"hide",opacity:"hide"},t.popupSpeed),clearVolumeTimer()}function muteclick(){i.options.onMuteClicked()}function unmuteclick(){i.options.onMuteClicked()}function autoHideVolume(){clearVolumeTimer(),r=setTimeout(hideVolume,3e3)}function clearVolumeTimer(){r&&clearTimeout(r)}var i=this,t=i.options,u,r;if(i.element.addClass("ui-playervolume"),u='<div id="'+t.ids.muteButtonWrapper+'"><button id="'+t.ids.muteButton+'" /></div><div id="'+t.ids.unmuteButtonWrapper+'"><button id="'+t.ids.unmuteButton+'" /></div><div id="'+t.ids.volumeDiv+'"><div id="'+t.ids.volumeSlider+'"></div></div>',i.divMarkup=n(u).appendTo(i.element),n("#"+t.ids.muteButton).attr({title:Mediasite.Player.Localization.Buttons.Mute}).imageButton(),n("#"+t.ids.unmuteButton).attr({title:Mediasite.Player.Localization.Buttons.UnMute}).imageButton(),window.navigator.msPointerEnabled){t.slider&&(n("#"+t.ids.unmuteButton).get(0).addEventListener("MSPointerOver",pointerOver),n("#"+t.ids.muteButton).get(0).addEventListener("MSPointerOver",pointerOver)),n("#"+t.ids.muteButton).get(0).addEventListener("MSPointerDown",mutepointerDown),n("#"+t.ids.unmuteButton).get(0).addEventListener("MSPointerDown",unmutepointerDown),n("#"+t.ids.muteButton).keyup(function(n){var t=n.keyCode||n.which;(t==13||t==32)&&mutepointerDown(n)}),n("#"+t.ids.unmuteButton).keyup(function(n){var t=n.keyCode||n.which;(t==13||t==32)&&unmutepointerDown(n)});function isMouse(n){return n.pointerType===n.MSPOINTER_TYPE_MOUSE||n.pointerType==="mouse"}function pointerOut(n){isMouse(n)&&(hideVolume(),i.element.unbind("mouseleave"))}function mutepointerDown(n){n.stopPropagation(),isMouse(n)?muteclick():toggleVolume()}function unmutepointerDown(n){n.stopPropagation(),isMouse(n)?unmuteclick():toggleVolume()}function pointerOver(n){isMouse(n)&&(i.element.mouseleave(pointerOut),showVolume())}function toggleVolume(){i.isVisible()?hideVolume():(showVolume(),autoHideVolume())}}else i.element.mouseleave(hideVolume),t.slider&&(n("#"+t.ids.unmuteButton).mouseenter(showVolume),n("#"+t.ids.muteButton).mouseenter(showVolume)),n("#"+t.ids.muteButton).mouseup(function(n){n.which==1&&muteclick()}).keyup(function(n){var t=n.keyCode||n.which;(t==13||t==32)&&muteclick()}),n("#"+t.ids.unmuteButton).mouseup(function(n){n.which==1&&muteclick()}).keyup(function(n){var t=n.keyCode||n.which;(t==13||t==32)&&unmuteclick()});n("#"+t.ids.unmuteButtonWrapper).hide(),n("#"+t.ids.volumeSlider).slider({orientation:"vertical",range:"min",slide:function(n,r){t.muted&&r.value>0&&i.unmute(),r.value===0&&i.mute();t.onVolumeChanged(r.value);autoHideVolume()},value:50}).attr({title:Mediasite.Player.Localization.Common.Volume}).css("cursor","pointer").enableTouch(),n(".ui-slider-handle").css("cursor","pointer"),n("#"+t.ids.volumeDiv).hide(),n(".ui-slider-range").addClass("ui-corner-all")},mute:function(){o=this.options,n("#"+o.ids.muteButtonWrapper).hide(),n("#"+o.ids.unmuteButtonWrapper).show(),o.muted=!0,o.previousVolume=n("#"+o.ids.volumeSlider).slider("option","value"),n("#"+o.ids.volumeSlider).slider("option","value",0)},unmute:function(){o=this.options;var t=arguments[0]!=undefined?arguments[0]:o.previousVolume;o.muted&&(n("#"+o.ids.unmuteButtonWrapper).hide(),n("#"+o.ids.muteButtonWrapper).show(),o.muted=!1),n("#"+o.ids.volumeSlider).slider("option","value",t)},isVisible:function(){var t=this.options;return n("#"+t.ids.volumeDiv).is(":visible")},disable:function(){var i=this,t=i.options;n("#"+t.ids.muteButton).imageButton("disable"),n("#"+t.ids.unmuteButtonWrapper).imageButton("disable")},destroy:function(){this.element.removeClass("ui-playervolume"),this.divMarkup.remove()}})})(jQuery)